[x] Playground
[x] Playground Cilium 
[x] APIServer crash
    - /var/log/pods
    - /var/log/syslog
    - journalctl -u unut
    - journalctl | grep unit
[x] API Server missconfigured
[x] API Server NodeRestriction
    - [x] What the NodeRestriction does? 
        - node-restriction.kubernetes.io label is reserved for administrators to 
          label their Node objects for workload isolation purposes, and kubelets 
          will not be allowed to modify labels with that prefix.
        - https://kubernetes.io/docs/reference/access-authn-authz/admission-controllers/#noderestriction
[REDO] AppArmor
    - [ ] do tutorials on AppArmor
        - apparmor_parser /root/profile
        - aa-status | grep nginx
    - apparmor_status
    - k explain deploy.spec.template.spec.securityContext.appArmorProfile   
[x] Auditing Enable Audit Logging
    - Important to set the flag names correctly
[x] CertificateSigningRequest sign manually
    - SOLUTION 1
        - openssl genrsa -out 60099.key 2048
        - openssl req -new -key 60099.key -out 60099.csr  
    - SOLUTION 2
        - k config set-credentials 60099@internal.users --client-key=60099.key --client-certificate=60099.crt
        - k config set-context 60099@internal.users --cluster=kubernetes --user=60099@internal.users
        - k config get-contexts
        - k config use-context 60099@internal.users  
        - k get ns
[REDO] CertificateSigningRequests sign via API
    - k get csr - get jsonoath for status.CRT
    - k config set-credential 60099@internal.users --client-key=60099.key --client-certificate=60099.crt
    - k config set-context 60099@internal.users --cluster=kubernetes --user=60099@internal.users
    - k config use-context 60099@internal.users
    - k get ns # won' work but the right error appears
[ ] CIS Benchmarks fix Controlplane
[ ] Container Hardening
[ ] Container Image Footprint User
[ ] Container Namespaces Docker
[ ] Falco Change Rule
[ ] ImagePolicyWebhook Setup
[ ] Image Use Digest
[ ] Image Vulnerability Scanning Trivy
[ ] Immutability Readonly Filesystem
[x] Ingress Create
    - easy one, keep in mind Prefix type
[x] Ingress Secure
    - openssl req -x509 -nodes -days 365 \
      -newkey rsa:2048 -keyout cert.key \
      -out cert.crt -subj "/CN=my.domain.com/O=my.domain.com"
[x] NetworkPolicy Create Default Deny
    - Make sure only needed 'policyTypes' are explicitely set
[x] NetworkPolicy Metadata Protection
    - Documentation k explain netpol.spec.egress.to.ipBlock should be <[]IPBlock> not <IPBlock>
    - submitted https://github.com/kubernetes/website/issues/53369#issuecomment-3564976108
[x] NetworkPolicy Namespace Selector
    - Easy, rememer again to specify **policyTypes**  
[ ] Privilege Escalation Containers
[ ] Privileged Containers
[ ] RBAC ServiceAccount Permissions
[ ] RBAC User Permissions
[ ] Sandbox gVisor
[ ] Secret ETCD Encryption
[x] Secret Access in PODS   
    - Quiet easy, remember to test and pay attention to secret as volume
      especially when it mounts as a file path, i.e. /etc/hosts will be volumeMounts[n].mountPath: /etc/
[x] Secret Read and Decode
    - Very handy to work with --field-selector + -o jsonpath + jq for several items 
[x] Secret ServiceAccount Pod
    - k explain very handy
    - k run my-pod --dry-run=client -o yaml > pod.yaml  
[ ] ServiceAccount Token Mounting
[ ] Static Manual Analysis Docker
[x] Static Manual Analysis K8s
    - securityContext 
    - dropCapabilities 
    - privileged
[ ] Syscall Activity Strace
[ ] System Hardening Close Open Ports
[ ] System Hardening Manage Packages
[x] Verify Platform Binaries 
    - sha256sum
    - systemctl status kubelet > check kubelet.service > find bin
        - /usr/bin/kubelet version
        - sha256sum it's bin
        - sha256sum downloaded bin
        - /usr/bin/kubelet version


